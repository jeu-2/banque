
<!-- SIMPLIFIED VERSION OF EXISTING INDEX PAGE -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Banque J.E.U. - Accueil</title>
</head>
<body>

<section class="section" id="inscription">
  <div class="auth-section">
    <h2 class="section-title">Rejoignez la communauté J.E.U.</h2>
    <div class="auth-tabs">
      <button class="tab-btn active" onclick="switchTab('signup')">S'inscrire</button>
      <button class="tab-btn" onclick="switchTab('login')">Se connecter</button>
    </div>

    <div class="auth-form" id="signup-form">
      <!-- formulaire d'inscription inchangé -->
    </div>

    <div class="auth-form" id="login-form">
      <form id="loginForm">
        <div class="form-group">
          <label class="form-label">Email ou Code membre</label>
          <input class="form-input" id="loginIdentifiant" placeholder="JEU000123 ou email" required>
        </div>
        <button class="btn-primary" type="submit">Se connecter</button>
      </form>
    </div>
  </div>
</section>

<!-- Script d'identification intégré -->
<script>
  document.getElementById("loginForm").addEventListener("submit", async function (e) {
    e.preventDefault();
    const identifiant = document.getElementById("loginIdentifiant").value.trim();
    const messageContainer = document.createElement("div");
    messageContainer.style.marginTop = "1rem";

    try {
      const response = await fetch("https://banque-api-jeu.onrender.com/api/membres");
      const membres = await response.json();

      const membre = membres.find(m =>
        m.email?.toLowerCase() === identifiant.toLowerCase() ||
        m.code?.toUpperCase() === identifiant.toUpperCase()
      );

      if (!membre) {
        messageContainer.textContent = "❌ Membre introuvable.";
        e.target.appendChild(messageContainer);
        return;
      }

      localStorage.setItem("recordId", membre.id);
      localStorage.setItem("codeMembre", membre.code);
      localStorage.setItem("nomMembre", membre.prenom + " " + membre.nom);
      messageContainer.textContent = "✅ Bienvenue " + membre.prenom + "! Redirection en cours...";
      e.target.appendChild(messageContainer);

      setTimeout(() => {
        window.location.href = "client/client.html";
      }, 1000);

    } catch (err) {
      console.error(err);
      messageContainer.textContent = "❌ Erreur réseau.";
      e.target.appendChild(messageContainer);
    }
  });
</script>

</body>
</html>
